### 12.12 Formatted Output 12.12 格式化输出

* https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Formatted-Output

The functions described in this section (`printf` and related functions) provide a convenient way to perform formatted output. You call `printf` with a **format string** or **template string** that specifies how to format the values of the remaining arguments.
本节中描述的函数(`printf` 和相关函数)提供了一种执行格式化输出的便捷方法。您可以使用*格式字符串*或*模板字符串*调用 `printf` 指定如何格式化其余参数的值。

Unless your program is a filter that specifically performs line- or character-oriented processing, using `printf` or one of the other related functions described in this section is usually the easiest and most concise way to perform output. These functions are especially useful for printing error messages, tables of data, and the like.
除非您的程序是专门执行面向行或字符的处理的过滤器，否则使用 `printf` 或本节中描述的其他相关函数之一通常是执行输出的最简单、最简洁的方法。这些函数对于打印错误消息、数据表等特别有用。

- Formatted Output Basics  格式化输出基础知识
- Output Conversion Syntax  输出转换语法
- Table of Output Conversions  Output Conversions 表格
- Integer Conversions  整数转换
- Floating-Point Conversions  浮点转换
- Other Output Conversions  其他输出转换
- Formatted Output Functions  格式化输出函数
- Dynamically Allocating Formatted Output  动态分配格式化输出
- Variable Arguments Output Functions  变量参数输出函数
- Parsing a Template String  解析模板字符串
- Example of Parsing a Template String  解析模板字符串的示例

#### 12.12.1 Formatted Output Basics
格式化输出基础知识

The `printf` function can be used to print any number of arguments. The template string argument you supply in a call provides information not only about the number of additional arguments, but also about their types and what style should be used for printing them.
`printf` 函数可用于打印任意数量的参数。您在调用中提供的 template string 参数不仅提供有关其他参数数量的信息，还提供有关其类型以及打印它们应使用何种样式的信息。

Ordinary characters in the template string are simply written to the output stream as-is, while *conversion specifications* introduced by a '%' character in the template cause subsequent arguments to be formatted and written to the output stream. For example,
模板字符串中的普通字符只是按原样写入输出流，而模板中 '%' 字符引入的*转换规范*会导致后续参数被格式化并写入输出流。例如

```c
int pct = 37;
char filename[] = "foo.txt";
printf("Processing of `%s' is %d%% finished.\nPlease be patient.\n",
    filename, pct);
```

produces output like 
生成类似

```
Processing of `foo.txt' is 37% finished.
Please be patient.

```

This example shows the use of the **'%d'** conversion to specify that an **`int`** argument should be printed in decimal notation, the **'%s'** conversion to specify printing of a **string** argument, and the **'%%'** conversion to print a literal **'%'** character.
此示例显示了如何使用 '%d' 转换来指定应以十进制表示法打印 `int` 参数，使用 '%s' 转换来指定字符串参数的打印，以及使用 '%%' 转换来打印文本 '%' 字符。

There are also conversions for printing an integer argument as an unsigned value in binary, octal, decimal, or hexadecimal radix (**'%b'**, **'%o'**, **'%u'**, or **'%x'**, respectively); or as a character value (**'%c'**).
还有用于将整数参数打印为二进制、八进制、十进制或十六进制基数(分别为 '%b'、'%o', '%u' 或 '%x')的无符号值的转换;或作为字符值 ('%c')。

Floating-point numbers can be printed in normal, fixed-point notation using the **'%f'** conversion or in exponential notation using the **'%e'** conversion. The **'%g'** conversion uses either '%e' or '%f' format, depending on what is more appropriate for the magnitude of the particular number.
浮点数可以使用 '%f' 转换以正常的定点表示法打印，也可以使用 '%e' 转换以指数表示法打印。'%g' 转换使用 '%e' 或 '%f' 格式，具体取决于哪种格式更适合特定数字的大小。

You can control formatting more precisely by writing *modifiers* between the '%' and the character that indicates which conversion to apply. These slightly alter the ordinary behavior of the conversion. For example, most conversion specifications permit you to specify a minimum field width and a flag indicating whether you want the result left- or right-justified within the field.
您可以通过编写*修饰符*来更精确地控制格式 在 '%' 和指示要应用的转换的字符之间。这些会略微改变转换的正常行为。例如，大多数转换规范都允许您指定最小字段宽度和一个标志，以指示您希望在字段中将结果左对齐还是右对齐。

The specific flags and modifiers that are permitted and their interpretation vary depending on the particular conversion. They're all described in more detail in the following sections. Don't worry if this all seems excessively complicated at first; you can almost always get reasonable free-format output without using any of the modifiers at all. The modifiers are mostly used to make the output look "prettier" in tables.
允许的特定标志和修饰符及其解释因特定转换而异。以下部分将更详细地介绍它们。如果这一切一开始看起来过于复杂，请不要担心;您几乎总是可以在不使用任何修饰符的情况下获得合理的 free-format 输出。修饰符主要用于使输出在表格中看起来 "更漂亮"。

#### 12.12.2 Output Conversion Syntax
输出转换语法

This section provides details about the precise syntax of conversion specifications that can appear in a `printf` template string.
本节提供有关 `printf` 模板字符串中可能出现的转换规范的精确语法的详细信息。

Characters in the template string that are not part of a conversion specification are printed as-is to the output stream. Multibyte character sequences (see [Character Set Handling](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Character-Set-Handling)) are permitted in a template string.
模板字符串中不属于转换规范的字符将按原样打印到输出流中。模板字符串中允许使用多字节字符序列(请参阅[字符集处理](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Character-Set-Handling))。

The conversion specifications in a `printf` template string have the general form:
`printf` 模板字符串中的转换规范具有一般形式：

```c
                标志   字段宽度   精度         类型修饰符 转换样式
% [ param-no $] flags width [ . precision ] type      conversion
%               -     10      . 8           l         d
```

or

```c
% [ param-no $] flags width . * [ param-no $] type conversion
```

For example, in the conversion specifier '%-10.8ld', the '-' is a flag, '10' specifies the field width, the precision is '8', the letter 'l' is a type modifier, and 'd' specifies the conversion style. (This particular type specifier says to print a `long int` argument in decimal notation, with a minimum of 8 digits left-justified in a field at least 10 characters wide.)
例如，在转换说明符 '%-10.8ld' 中，'-' 是一个标志，'10' 指定字段宽度，精度是 '8'，字母 'l' 是类型修饰符，'d' 指定转换样式。(这个特定的类型说明符说以十进制表示法打印`一个 long int` 参数，在至少 10 个字符宽的字段中至少左对齐 8 位数字。)

In more detail, output conversion specifications consist of an initial '%' character followed in sequence by:
更详细地说，output conversion specifications 由一个初始 '%' 字符后跟 sequence 组成：

- An optional specification of the parameter used for this format. Normally the parameters to the `printf` function are assigned to the formats in the order of appearance in the format string. But in some situations (such as message translation) this is not desirable and this extension allows an explicit parameter to be specified.
  用于此格式的参数的可选规范。 通常，`printf` 函数的参数被分配给 格式。 但在一些 情况(例如消息翻译)这是不可取的，并且 this extension 允许指定显式参数。

  The param-no parts of the format must be integers in the range of 1 to the maximum number of arguments present to the function call. Some implementations limit this number to a certain upper bound. The exact limit can be retrieved by the following constant.
  格式的 param-no 部分必须是 1 到 function call 存在的最大参数数范围内的整数。某些 implementations 将此数字限制为某个上限。确切的限制可以通过以下常量来检索。

  Macro: [**NL_ARGMAX**](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#index-NL_005fARGMAX)

  The value of `NL_ARGMAX` is the maximum value allowed for the specification of a positional parameter in a `printf` call. The actual value in effect at runtime can be retrieved by using `sysconf` using the `_SC_NL_ARGMAX` parameter see [Definition of `sysconf`](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Sysconf-Definition).
  `值 NL_ARGMAX` 是在 `printf` 调用中指定位置参数所允许的最大值。 这 运行时有效的实际值可以通过使用 使用 `_SC_NL_ARGMAX` 参数的 `sysconf` 请参阅 [`sysconf` 的定义](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Sysconf-Definition)。

  Some systems have a quite low limit such as *9* for System V systems. The GNU C Library has no real limit.
  某些系统具有相当低的限制，例如系统 V 为 *9* 系统。 GNU C 库没有真正的限制。

  If any of the formats has a specification for the parameter position all of them in the format string shall have one. Otherwise the behavior is undefined.
  如果任何格式具有参数 position 的规范，则格式字符串中的所有格式都应具有 1 参数 position。否则，行为未定义。

- Zero or more *flag characters* that modify the normal behavior of the conversion specification.
  零个或多个修改转换规范的正常行为的*标志字符*。

- An optional decimal integer specifying the *minimum field width*. If the normal conversion produces fewer characters than this, the field is padded with spaces to the specified width. This is a *minimum* value; if the normal conversion produces more characters than this, the field is *not* truncated. Normally, the output is right-justified within the field.
  一个可选的十进制整数，用于指定*最小字段宽度*。 如果正常转换生成的字符数少于此值，则字段 用空格填充到指定的宽度。 这是*最低限度* 价值;如果 Normal 转换生成的字符数超过此值，则 field *不会*被截断。 通常，输出是右对齐的 在字段中。

  You can also specify a field width of '*'. This means that the next argument in the argument list (before the actual value to be printed) is used as the field width. The value must be an `int`. If the value is negative, this means to set the '-' flag (see below) and to use the absolute value as the field width.
  您还可以指定字段宽度 ' * "。这意味着参数列表中的下一个参数(在要打印的实际值之前)用作字段宽度。该值必须是 `int`。如果值为负数，则表示设置 ' - ' 标志(见下文)并使用绝对值作为字段宽度。

- An optional *precision* to specify the number of digits to be written for the numeric conversions. If the precision is specified, it consists of a period ('.') followed optionally by a decimal integer (which defaults to zero if omitted).
  *用于指定要* 为数字转换而编写。 如果指定了精度，则 由一个句点 (' . ') 组成，后跟一个十进制整数(可选) (如果省略，则默认为零)。

  You can also specify a precision of '*'. This means that the next argument in the argument list (before the actual value to be printed) is used as the precision. The value must be an `int`, and is ignored if it is negative. If you specify '*' for both the field width and precision, the field width argument precedes the precision argument. Other C library versions may not recognize this syntax.
  您还可以指定 ' * ' 的精度。这意味着参数列表中的下一个参数(在要打印的实际值之前)用作精度。该值必须是 `int`，如果为负数，则忽略该值。如果为字段宽度和精度指定 ' * '，则字段宽度参数位于 precision 参数之前。其他 C 库版本可能无法识别此语法。

- An optional *type modifier character*, which is used to specify the data type of the corresponding argument if it differs from the default type. (For example, the integer conversions assume a type of `int`, but you can specify 'h', 'l', or 'L' for other integer types.)
  可选的*类型修饰符*字符，用于指定相应参数的数据类型(如果它与默认类型不同)。(例如，整数转换假定 `int` 类型，但您可以为其他整数类型指定 ' h '、' l ' 或 ' L '。)

- A character that specifies the conversion to be applied.
  指定要应用的转换的字符。

The exact options that are permitted and how they are interpreted vary between the different conversion specifiers. See the descriptions of the individual conversions for information about the particular options that they use.
允许的确切选项及其解释方式因不同的 conversion 说明符而异。请参阅 各个转化的描述 ，以了解有关它们使用的特定选项的信息。

With the '-Wformat' option, the GNU C compiler checks calls to `printf` and related functions. It examines the format string and verifies that the correct number and types of arguments are supplied. There is also a GNU C syntax to tell the compiler that a function you write uses a `printf`-style format string. See [Declaring Attributes of Functions](https://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#Function-Attributes) in Using GNU CC, for more information.
使用 ' -Wformat ' 选项，GNU C 编译器会检查对 `printf` 和相关函数。它检查格式字符串并验证是否提供了正确的参数数量和类型。还有一个 GNU C 语法，用于告诉编译器您编写的函数使用 `printf` 样式的格式字符串。有关更多信息，请参阅使用 GNU CC 中的[声明函数的属性](https://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#Function-Attributes)。

#### 12.12.3 Table of Output Conversions
输出转换表

Here is a table summarizing what all the different conversions do:
下表总结了所有不同转换的作用：

- '%d', '%i'
  Print an integer as a signed decimal number. See [Integer Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Integer-Conversions), for details. '%d' and '%i' are synonymous for output, but are different when used with `scanf` for input (see [Table of Input Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Table-of-Input-Conversions)).
  将整数打印为有符号十进制数。有关详细信息，请参阅 [Integer Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Integer-Conversions)。'%d' 和 '%i' 是 output 的同义词，但在与 `scanf` 一起用于 input 时是不同的(请参阅 [Table of Input Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Table-of-Input-Conversions))。

- '%b', '%B'
  Print an integer as an unsigned binary number. '%b' uses lower-case 'b' with the '#' flag and '%B' uses upper-case. '%b' is an ISO C2X feature; '%B' is an extension recommended by ISO C2X. See [Integer Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Integer-Conversions), for details.
  将整数打印为无符号二进制数。' %b ' 使用小写 ' b ' 和 ' # ' 标志，' %B ' 使用大写。' %b ' 是 ISO C2X 特征;' %B ' 是 ISO C2X 推荐的扩展名。有关详细信息，请参阅 [Integer Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Integer-Conversions)。

- '%o'
  Print an integer as an unsigned octal number. See [Integer Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Integer-Conversions), for details.
  将整数打印为无符号八进制数。有关详细信息，请参阅 [Integer Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Integer-Conversions)。

- '%u'
  Print an integer as an unsigned decimal number. See [Integer Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Integer-Conversions), for details.
  将整数打印为无符号十进制数。有关详细信息，请参阅 [Integer Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Integer-Conversions)。

- '%x', '%X'
  Print an integer as an unsigned hexadecimal number. '%x' uses lower-case letters and '%X' uses upper-case. See [Integer Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Integer-Conversions), for details.
  将整数打印为无符号十六进制数。' %x ' 使用小写字母，' %X ' 使用大写字母。有关详细信息，请参阅 [Integer Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Integer-Conversions)。

- '%f'
  Print a floating-point number in normal (fixed-point) notation. See [Floating-Point Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Floating_002dPoint-Conversions), for details.
  以普通(定点)表示法打印浮点数。有关详细信息，请参阅 [浮点转换](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Floating_002dPoint-Conversions) 。

- '%e', '%E'
  Print a floating-point number in exponential notation. '%e' uses lower-case letters and '%E' uses upper-case. See [Floating-Point Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Floating_002dPoint-Conversions), for details.
  以指数表示法打印浮点数。' %e ' 使用小写字母，' %E ' 使用大写字母。有关详细信息，请参阅 [浮点转换](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Floating_002dPoint-Conversions) 。

- '%g', '%G'
  Print a floating-point number in either normal or exponential notation, whichever is more appropriate for its magnitude. '%g' uses lower-case letters and '%G' uses upper-case. See [Floating-Point Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Floating_002dPoint-Conversions), for details.
  以正常或指数表示法打印浮点数，以更适合其大小的方式显示。' %g ' 使用小写字母，' %G ' 使用大写字母。有关详细信息，请参阅 [浮点转换](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Floating_002dPoint-Conversions) 。

- '%a', '%A'
  Print a floating-point number in a hexadecimal fractional notation with the exponent to base 2 represented in decimal digits. '%a' uses lower-case letters and '%A' uses upper-case. See [Floating-Point Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Floating_002dPoint-Conversions), for details.
  以十六进制小数表示法打印浮点数，以十进制数字表示以 2 为基数的指数。' %a ' 使用小写字母，' %A ' 使用大写字母。有关详细信息，请参阅 [浮点转换](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Floating_002dPoint-Conversions) 。

- '%c'
  Print a single character. See [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions).
  打印单个字符。请参阅 [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions)。

- '%C'
  This is an alias for '%lc' which is supported for compatibility with the Unix standard.
  这是 ' %lc ' 的别名，支持与 Unix 标准兼容。

- '%s'
  Print a string. See [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions).
  打印字符串。请参阅 [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions)。

- '%S'
  This is an alias for '%ls' which is supported for compatibility with the Unix standard.
  这是 ' %ls ' 的别名，支持与 Unix 标准兼容。

- '%p'
  Print the value of a pointer. See [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions).
  打印指针的值。请参阅 [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions)。

- '%n'
  Get the number of characters printed so far. See [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions). Note that this conversion specification never produces any output.
  获取到目前为止打印的字符数。请参阅 [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions)。请注意，此 conversion 规范永远不会产生任何输出。

- '%m'
  Print the string corresponding to the value of `errno`. (This is a GNU extension.) See [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions).
  打印与 `errno` 的值对应的字符串。(这是一个 GNU 扩展。请参阅 [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions))。

- '%%'
  Print a literal '%' character. See [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions).
  打印文本 ' % ' 字符。请参阅 [Other Output Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Other-Output-Conversions)。

If the syntax of a conversion specification is invalid, unpredictable things will happen, so don't do this. If there aren't enough function arguments provided to supply values for all the conversion specifications in the template string, or if the arguments are not of the correct types, the results are unpredictable. If you supply more arguments than conversion specifications, the extra argument values are simply ignored; this is sometimes useful.
如果转换规范的语法无效，则会发生不可预知的事情，因此请不要这样做。如果没有足够的函数参数来为模板字符串中的所有转换规范提供值，或者参数的类型不正确，则结果是不可预测的。如果提供的参数多于转换规范，则只会忽略额外的参数值;这有时很有用。

#### 12.12.4 Integer Conversions
整数转换

This section describes the options for the '%d', '%i', '%b', '%B', '%o', '%u', '%x', and '%X' conversion specifications. These conversions print integers in various formats.
本节介绍 ' %d '， ' %i '， ' %b '， ' '， %B ' '， %o %u %x %X ' '， ' ' 转换规范的选项。这些转换以各种格式打印整数。

The '%d' and '%i' conversion specifications both print an `int` argument as a signed decimal number; while 'b', '%o', '%u', and '%x' print the argument as an unsigned binary, octal, decimal, or hexadecimal number (respectively). The '%X' conversion specification is just like '%x' except that it uses the characters 'ABCDEF' as digits instead of 'abcdef'. The '%B' conversion specification is just like '%b' except that, with the '#' flag, the output starts with '0B' instead of '0b'.
' %d ' 和 ' %i ' 转换规范都打印 `int` 参数作为带符号的十进制数;而 ' b '、' '、' %o %u ' 和 ' %x ' 将参数打印为无符号二进制、八进制、十进制或十六进制数(分别)。' %X ' 转换规范与 ' %x ' 类似，不同之处在于它使用字符 ' ABCDEF ' 作为数字，而不是 ' abcdef '。' %B ' 转换规范与 ' %b ' 类似，不同之处在于，使用 ' # ' 标志时，输出以 ' 0B ' 而不是 ' 0b ' 开头。

The following flags are meaningful:
以下标志是有意义的：

- '-'
  Left-justify the result in the field (instead of the normal right-justification).
  在字段中左对齐结果(而不是正常的右对齐)。

- '+'
  For the signed '%d' and '%i' conversions, print a plus sign if the value is positive.
  对于有符号的 ' %d ' 和 ' %i ' 转换，如果值为正数，则打印加号。

- ' '
  For the signed '%d' and '%i' conversions, if the result doesn't start with a plus or minus sign, prefix it with a space character instead. Since the '+' flag ensures that the result includes a sign, this flag is ignored if you supply both of them.
  对于有符号的 ' %d ' 和 ' %i ' 转换，如果结果不以加号或减号开头，请改为在它前面加上一个空格字符。由于 ' + ' 标志可确保结果包含符号，因此如果同时提供这两个标志，则会忽略此标志。

- '#'
  For the '%o' conversion, this forces the leading digit to be '0', as if by increasing the precision. For '%x' or '%X', this prefixes a leading '0x' or '0X' (respectively) to the result. For '%b' or '%B', this prefixes a leading '0b' or '0B' (respectively) to the result. This doesn't do anything useful for the '%d', '%i', or '%u' conversions. Using this flag produces output which can be parsed by the `strtoul` function (see [Parsing of Integers](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Parsing-of-Integers)) and `scanf` with the '%i' conversion (see [Numeric Input Conversions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Numeric-Input-Conversions)).
  对于 ' %o ' 转换，这会强制前导数字为 ' 0 '，就像提高精度一样。对于 ' %x ' 或 ' %X '，这会在结果前面加上前面的 ' 0x ' 或 ' 0X ' (分别)。对于 ' %b ' 或 ' %B '，这会在结果前面加上前面的 ' 0b ' 或 ' 0B ' (分别)。这对 ' %d '、' %i ' 或 ' %u ' 转换没有任何用处。使用此标志生成可由 `strtoul` 函数解析的输出(请参阅 [整数解析](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Parsing-of-Integers))和 `scanf` 与 ' %i ' 转换(请参阅 [数字输入转换](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Numeric-Input-Conversions))。

  For the '%m' conversion, print an error constant or decimal error number, instead of a (possibly translated) error message.
  对于 ' %m ' 转换，打印错误常量或十进制错误号，而不是(可能翻译的)错误消息。

- '''
  Separate the digits into groups as specified by the locale specified for the `LC_NUMERIC` category; see [Generic Numeric Formatting Parameters](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#General-Numeric). This flag is a GNU extension.
  根据为 `LC_NUMERIC` 类别指定的区域设置，将数字分成多个组;请参阅 [通用数值格式参数](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#General-Numeric)。这个标志是一个 GNU 扩展。

- '0'
  Pad the field with zeros instead of spaces. The zeros are placed after any indication of sign or base. This flag is ignored if the '-' flag is also specified, or if a precision is specified.
  用零而不是空格填充字段。零放在任何 sign 或 base 指示之后。如果还指定了 ' - ' 标志，或者指定了精度，则忽略此标志。

If a precision is supplied, it specifies the minimum number of digits to appear; leading zeros are produced if necessary. If you don't specify a precision, the number is printed with as many digits as it needs. If you convert a value of zero with an explicit precision of zero, then no characters at all are produced.
如果提供了精度，则指定要显示的最小位数;如有必要，将生成前导零。如果未指定精度，则根据需要打印该数字。如果转换显式精度为零的值 0，则根本不生成任何字符。

Without a type modifier, the corresponding argument is treated as an `int` (for the signed conversions '%i' and '%d') or `unsigned int` (for the unsigned conversions '%b', '%B', '%o', '%u', '%x', and '%X'). Recall that since `printf` and friends are variadic, any `char` and `short` arguments are automatically converted to `int` by the default argument promotions. For arguments of other integer types, you can use these modifiers:
如果没有类型修饰符，则相应的参数将被视为 `int` (对于有符号转换 ' %i ' 和 ' %d ') 或 `unsigned int` (对于无符号转换 ' %b '， ' %B '， ' %o '， ' %u '， ' %x ' 和 ' %X ')。回想一下，由于 `printf` 和 friends 是可变的，因此任何 `char` 和 `short` 参数都会通过默认参数 promotions 自动转换为 `int`。对于其他整数类型的参数，您可以使用以下修饰符：

- 'hh'
  Specifies that the argument is a `signed char` or `unsigned char`, as appropriate. A `char` argument is converted to an `int` or `unsigned int` by the default argument promotions anyway, but the 'hh' modifier says to convert it back to a `char` again.
  根据需要，指定参数是 `signed char` 或 `unsigned char`。`char` 参数转换为 `int` 或 `unsigned int` 替换为默认参数 promotions，但 ' hh ' 修饰符表示将其转换回 `char` 再次调用。

  This modifier was introduced in ISO C99.
  此修饰符是在 ISO C99 中引入的。

- 'h'
  Specifies that the argument is a `short int` or `unsigned short int`, as appropriate. A `short` argument is converted to an `int` or `unsigned int` by the default argument promotions anyway, but the 'h' modifier says to convert it back to a `short` again.
  根据需要指定参数为 `short int` 或 `unsigned short int`。`短`参数将转换为 `int` 或 `unsigned int` 替换为默认参数 promotions，但 ' h ' 修饰符表示将其转换回 `又短`了。

- 'j'
  Specifies that the argument is a `intmax_t` or `uintmax_t`, as appropriate.
  根据需要指定参数为 `intmax_t` 或 `uintmax_t`。

  This modifier was introduced in ISO C99.
  此修饰符是在 ISO C99 中引入的。

- 'l'
  Specifies that the argument is a `long int` or `unsigned long int`, as appropriate. Two 'l' characters are like the 'L' modifier, below.
  根据需要，指定参数为 `long int` 或 `unsigned long int`。两个 ' l ' 字符类似于下面的 ' L ' 修饰符。

  If used with '%c' or '%s' the corresponding parameter is considered as a wide character or wide character string respectively. This use of 'l' was introduced in Amendment 1 to ISO C90.
  如果与 ' %c ' 或 ' %s ' 一起使用，则相应的参数将分别被视为宽字符或宽字符串。' l ' 的这种用法是在 ISO C90 的修正案 1 中引入的。

- 'L'
- 'll'
- 'q'
  Specifies that the argument is a `long long int`. (This type is an extension supported by the GNU C compiler. On systems that don't support extra-long integers, this is the same as `long int`.)
  指定参数为 `long long int`。(此类型是 GNU C 编译器支持的扩展。在不支持超长整数的系统上，这与 `long int` 相同。

  The 'q' modifier is another name for the same thing, which comes from 4.4 BSD; a `long long int` is sometimes called a "quad" `int`.  
  ' q ' 修饰符是同一事物的另一个名称，来自 4.4 BSD;`long long int` 有时称为"四边形" `int` 的

- 't'
  Specifies that the argument is a `ptrdiff_t`.
  指定参数为 `ptrdiff_t`。

  This modifier was introduced in ISO C99.
  此修饰符是在 ISO C99 中引入的。

- 'z'
- 'Z'
  Specifies that the argument is a `size_t`.
  指定参数为 `size_t`。

  'z' was introduced in ISO C99. 'Z' is a GNU extension predating this addition and should not be used in new code.
  ' z ' 在 ISO C99 中引入。' Z ' 是早于此添加的 GNU 扩展，不应用于新代码中。

Here is an example. Using the template string:
下面是一个示例。使用模板字符串：

```c
"|%5d|%-5d|%+5d|%+-5d|% 5d|%05d|%5.0d|%5.2d|%d|\n"
```

to print numbers using the different options for the '%d' conversion gives results like:
使用不同的 ' %d ' 转换选项打印数字，会得到如下结果：

|    0|0    |   +0|+0   |    0|00000|     |   00|0|
|    1|1    |   +1|+1   |    1|00001|    1|   01|1|
|   -1|-1   |   -1|-1   |   -1|-0001|   -1|  -01|-1|
|100000|100000|+100000|+100000| 100000|100000|100000|100000|100000|

In particular, notice what happens in the last case where the number is too large to fit in the minimum field width specified.
特别是，请注意在最后一种情况下会发生什么情况，即数字太大而无法容纳指定的最小字段宽度。

Here are some more examples showing how unsigned integers print under various format options, using the template string:
以下是一些更多示例，展示了如何使用模板字符串在各种格式选项下打印无符号整数：

```c
"|%5u|%5o|%5x|%5X|%#5o|%#5x|%#5X|%#10.8x|\n"
```

|    0|    0|    0|    0|    0|    0|    0|  00000000|
|    1|    1|    1|    1|   01|  0x1|  0X1|0x00000001|
|100000|303240|186a0|186A0|0303240|0x186a0|0X186A0|0x000186a0|

#### 12.12.5 Floating-Point Conversions
浮点转换

This section discusses the conversion specifications for floating-point numbers: the '%f', '%e', '%E', '%g', and '%G' conversions.
本节讨论浮点数的转换规范：' %f '、 ' %e 、 ' %E 、 %g ' 和 ' %G 。

The '%f' conversion prints its argument in fixed-point notation, producing output of the form [`-`]ddd`.`ddd, where the number of digits following the decimal point is controlled by the precision you specify.
' %f ' 转换以定点表示法打印其参数，生成 [`-`]ddd 形式的输出`。`ddd，其中小数点后的数字数由您指定的精度控制。

The '%e' conversion prints its argument in exponential notation, producing output of the form [`-`]d`.`ddd`e`[`+`|`-`]dd. Again, the number of digits following the decimal point is controlled by the precision. The exponent always contains at least two digits. The '%E' conversion is similar but the exponent is marked with the letter 'E' instead of 'e'.
' %e ' 转换以指数表示法打印其参数，生成 [`-`]d 形式的输出`。`ddd`e`[`+`|`-`]dd. 同样，小数点后的数字数由精度控制。指数始终至少包含两位数。' %E ' 转换类似，但指数标有字母 ' E ' 而不是 ' e '。

The '%g' and '%G' conversions print the argument in the style of '%e' or '%E' (respectively) if the exponent would be less than -4 or greater than or equal to the precision; otherwise they use the '%f' style. A precision of `0`, is taken as 1. Trailing zeros are removed from the fractional portion of the result and a decimal-point character appears only if it is followed by a digit.
如果指数小于 -4 或大于或等于精度，则 ' %g ' 和 ' %G ' 转换将以 ' %e ' 或 ' %E ' (分别)的样式打印参数;否则，它们使用 ' %f ' 样式。精度为 `0` 时，取为 1。从结果的小数部分中删除尾随零，并且仅当小数点字符后跟数字时，才会显示小数点字符。

The '%a' and '%A' conversions are meant for representing floating-point numbers exactly in textual form so that they can be exchanged as texts between different programs and/or machines. The numbers are represented in the form [`-`]`0x`h`.`hhh`p`[`+`|`-`]dd. At the left of the decimal-point character exactly one digit is print. This character is only `0` if the number is denormalized. Otherwise the value is unspecified; it is implementation dependent how many bits are used. The number of hexadecimal digits on the right side of the decimal-point character is equal to the precision. If the precision is zero it is determined to be large enough to provide an exact representation of the number (or it is large enough to distinguish two adjacent values if the `FLT_RADIX` is not a power of 2, see [Floating Point Parameters](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Floating-Point-Parameters)). For the '%a' conversion lower-case characters are used to represent the hexadecimal number and the prefix and exponent sign are printed as `0x` and `p` respectively. Otherwise upper-case characters are used and `0X` and `P` are used for the representation of prefix and exponent string. The exponent to the base of two is printed as a decimal number using at least one digit but at most as many digits as necessary to represent the value exactly.
' %a ' 和 ' %A ' 转换旨在以文本形式精确表示浮点数，以便它们可以在不同程序和/或机器之间作为文本进行交换。数字以 [`-`]`0x`h 的形式表示`。`HHH`P`[`+`|`-`]dd. 在小数点字符的左侧，正好打印一位数字。如果数字非规范化，则此字符仅为 `0`。否则，该值未指定;使用多少位取决于实现。小数点字符右侧的十六进制位数等于精度。如果精度为零，则确定它足够大以提供数字的精确表示形式(或者如果精度不是 2 的幂，则它足够大以区分两个相邻值，如果`FLT_RADIX`不是 2 的幂，请参阅 [浮点参数](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Floating-Point-Parameters))。对于 ' %a ' 转换，小写字符用于表示十六进制数，前缀和指数符号打印为 `0x` 和 `p` 分别。 否则使用大写字符和 `0X` 和 `P` 用于表示前缀和指数字符串。以 2 为底的指数打印为十进制数，至少使用一位数字，但最多使用精确表示该值所需的数字。

If the value to be printed represents infinity or a NaN, the output is [`-`]`inf` or `nan` respectively if the conversion specifier is '%a', '%e', '%f', or '%g' and it is [`-`]`INF` or `NAN` respectively if the conversion is '%A', '%E', or '%G'. On some implementations, a NaN may result in longer output with information about the payload of the NaN; ISO C2X defines a macro `_PRINTF_NAN_LEN_MAX` giving the maximum length of such output.
如果要打印的值表示无穷大或 NaN，则如果转换说明符为 ' %a '、' %e '、' %f ' 或 ' %g '，则输出分别为 [`-`]`inf` 或 `nan`，如果转换为 ' %A '、' %E ' 或 ' %G '，则分别为 [`-`]`INF` 或 `NAN`。在某些实现中，NaN 可能会导致更长的输出，其中包含有关 NaN 有效负载的信息;ISO C2X 定义了一个宏`_PRINTF_NAN_LEN_MAX`，给出了此类输出的最大长度。

The following flags can be used to modify the behavior:
以下标志可用于修改行为：

- '-'
  Left-justify the result in the field. Normally the result is right-justified.
  在字段中左对齐结果。通常，结果是右对齐的。

- '+'
  Always include a plus or minus sign in the result.
  结果中始终包含加号或减号。

- ' '
  If the result doesn't start with a plus or minus sign, prefix it with a space instead. Since the '+' flag ensures that the result includes a sign, this flag is ignored if you supply both of them.
  如果结果不以加号或减号开头，请改为在它前面加上一个空格。由于 ' + ' 标志可确保结果包含符号，因此如果同时提供这两个标志，则会忽略此标志。

- '#'
  Specifies that the result should always include a decimal point, even if no digits follow it. For the '%g' and '%G' conversions, this also forces trailing zeros after the decimal point to be left in place where they would otherwise be removed.
  指定结果应始终包含小数点，即使其后没有数字。对于 ' %g ' 和 ' %G ' 转换，这还会强制将小数点后的尾随零保留在原本会删除的位置。

- '''
  Separate the digits of the integer part of the result into groups as specified by the locale specified for the `LC_NUMERIC` category; see [Generic Numeric Formatting Parameters](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#General-Numeric). This flag is a GNU extension.
  将结果的整数部分的数字分成由为 `LC_NUMERIC` 类别指定的区域设置指定的组中;请参阅 [通用数值格式参数](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#General-Numeric)。这个标志是一个 GNU 扩展。

- '0'
  Pad the field with zeros instead of spaces; the zeros are placed after any sign. This flag is ignored if the '-' flag is also specified.
  用零而不是空格填充字段;零放在任何符号之后。如果还指定了 ' - ' 标志，则忽略此标志。

The precision specifies how many digits follow the decimal-point character for the '%f', '%e', and '%E' conversions. For these conversions, the default precision is `6`. If the precision is explicitly `0`, this suppresses the decimal point character entirely. For the '%g' and '%G' conversions, the precision specifies how many significant digits to print. Significant digits are the first digit before the decimal point, and all the digits after it. If the precision is `0` or not specified for '%g' or '%G', it is treated like a value of `1`. If the value being printed cannot be expressed accurately in the specified number of digits, the value is rounded to the nearest number that fits.
精度指定 ' %f '、 ' %e ' 和 ' %E ' 转换的小数点字符后面的数字数。对于这些转换，默认精度为 `6`。如果精度显式为 `0`，则完全隐藏小数点字符。对于 ' %g ' 和 ' %G ' 转换，精度指定要打印的有效数字数。有效数字是小数点前的第一个数字，以及小数点后的所有数字。如果精度为 `0` 或未为 ' %g ' 或 ' %G ' 指定，则将其视为值 `1`。如果打印的值无法以指定的位数准确表示，则该值将四舍五入为最接近的合适数字。

Without a type modifier, the floating-point conversions use an argument of type `double`. (By the default argument promotions, any `float` arguments are automatically converted to `double`.) The following type modifier is supported:
如果没有类型修饰符，浮点转换将使用 `double` 类型的参数。 (通过默认参数 promotions，任何 `float` 参数会自动转换为 `double`。支持以下类型修饰符：

- 'L'
  An uppercase 'L' specifies that the argument is a `long double`.
  大写的 ' L ' 指定参数是一个`长双精度`。

Here are some examples showing how numbers print using the various floating-point conversions. All of the numbers were printed using this template string:
以下是一些示例，显示了如何使用各种浮点转换打印数字。所有数字都是使用此模板字符串打印的：

```c
"|%13.4a|%13.4f|%13.4e|%13.4g|\n"
```

Here is the output:  这是输出：

|  0x0.0000p+0|       0.0000|   0.0000e+00|            0|
|  0x1.0000p-1|       0.5000|   5.0000e-01|          0.5|
|  0x1.0000p+0|       1.0000|   1.0000e+00|            1|
| -0x1.0000p+0|      -1.0000|  -1.0000e+00|           -1|
|  0x1.9000p+6|     100.0000|   1.0000e+02|          100|
|  0x1.f400p+9|    1000.0000|   1.0000e+03|         1000|
| 0x1.3880p+13|   10000.0000|   1.0000e+04|        1e+04|
| 0x1.81c8p+13|   12345.0000|   1.2345e+04|    1.234e+04|
| 0x1.86a0p+16|  100000.0000|   1.0000e+05|        1e+05|
| 0x1.e240p+16|  123456.0000|   1.2346e+05|    1.235e+05|

Notice how the '%g' conversion drops trailing zeros.
请注意 ' %g ' 转换如何删除尾随零。

#### 12.12.6 Other Output Conversions
其他输出转换

This section describes miscellaneous conversions for `printf`.
本节介绍 `printf` 的其他转换。

The '%c' conversion prints a single character. In case there is no 'l' modifier the `int` argument is first converted to an `unsigned char`. Then, if used in a wide stream function, the character is converted into the corresponding wide character. The '-' flag can be used to specify left-justification in the field, but no other flags are defined, and no precision or type modifier can be given. For example:
' %c ' 转换打印单个字符。如果没有 ' l ' 修饰符，`则 int` 参数首先转换为 `unsigned char` 的然后，如果在 wide stream 函数中使用，则该字符将转换为相应的 wide 字符。' - ' 标志可用于指定字段中的左对齐，但未定义其他标志，并且不能给出精度或类型修饰符。例如：

```c
printf ("%c%c%c%c%c", 'h', 'e', 'l', 'l', 'o');
```

prints 'hello'.

If there is an 'l' modifier present the argument is expected to be of type `wint_t`. If used in a multibyte function the wide character is converted into a multibyte character before being added to the output. In this case more than one output byte can be produced.
如果存在 ' l ' 修饰符，则参数应为 `wint_t` 类型。如果在多字节函数中使用，则宽字符在添加到输出之前将转换为多字节字符。在这种情况下，可以生成多个 output 字节。

The '%s' conversion prints a string. If no 'l' modifier is present the corresponding argument must be of type `char *` (or `const char *`). If used in a wide stream function the string is first converted to a wide character string. A precision can be specified to indicate the maximum number of characters to write; otherwise characters in the string up to but not including the terminating null character are written to the output stream. The '-' flag can be used to specify left-justification in the field, but no other flags or type modifiers are defined for this conversion. For example:
' %s ' 转换打印字符串。如果不存在 ' l ' 修饰符，则相应的参数必须是 `char *` 类型(或 `const char *`) 的 Const Char *)。如果在宽流函数中使用，则字符串首先转换为宽字符串。可以指定精度来指示要写入的最大字符数;否则，字符串中直到(不包括终止 NULL 字符)的字符将写入输出流。' - ' 标志可用于在字段中指定左对齐，但未为此转换定义其他标志或类型修饰符。例如：

```c
printf ("%3s%-6s", "no", "where");
```

prints ' nowhere '.

If there is an 'l' modifier present, the argument is expected to be of type `wchar_t` (or `const wchar_t *`).
如果存在 ' l ' 修饰符，则参数应为 `wchar_t` 类型(或 `const wchar_t *`)。

If you accidentally pass a null pointer as the argument for a '%s' conversion, the GNU C Library prints it as '(null)'. We think this is more useful than crashing. But it's not good practice to pass a null argument intentionally.
如果您不小心传递了一个空指针作为 ' %s ' 转换的参数，GNU C 库会将其打印为 ' (null) '。我们认为这比崩溃更有用。但是，有意传递 null 参数并不是一个好的做法。

The '%m' conversion prints the string corresponding to the error code in `errno`. See [Error Messages](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Error-Messages). Thus:
' %m ' 转换打印与 `errno` 中的错误代码对应的字符串。请参阅[错误消息](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Error-Messages)。因此：

```c
fprintf (stderr, "can't open `%s': %m\n", filename);
```

is equivalent to:

```c
fprintf (stderr, "can't open `%s': %s\n", filename, strerror (errno));
```

The '%m' conversion can be used with the '#' flag to print an error constant, as provided by `strerrorname_np`. Both '%m' and '%#m' are GNU C Library extensions.
' %m ' 转换可以与 ' # ' 标志一起使用，以打印 `strerrorname_np` 提供的错误常量。' %m ' 和 ' %#m ' 都是 GNU C 库扩展。

The '%p' conversion prints a pointer value. The corresponding argument must be of type `void *`. In practice, you can use any type of pointer.
' %p ' 转换打印指针值。相应的参数必须为 `void *` 类型。在实践中，您可以使用任何类型的指针。

In the GNU C Library, non-null pointers are printed as unsigned integers, as if a '%#x' conversion were used. Null pointers print as '(nil)'. (Pointers might print differently in other systems.)
在 GNU C 库中，非 null 指针被打印为无符号整数，就像使用了 ' %#x ' 转换一样。空指针打印为 ' (nil) '。(指针在其他系统中的打印方式可能会有所不同。

For example:  例如：

```c
printf ("%p", "testing");
```

prints '0x' followed by a hexadecimal number—the address of the string constant `"testing"`. It does not print the word 'testing'.
打印 ' 0x ' 后跟一个十六进制数 - 字符串常量 `"testing"` 的地址。它不会打印单词 ' testing '。

You can supply the '-' flag with the '%p' conversion to specify left-justification, but no other flags, precision, or type modifiers are defined.
可以将 ' - ' 标志与 ' %p ' 转换一起提供，以指定左对齐，但未定义其他标志、精度或类型修饰符。

The '%n' conversion is unlike any of the other output conversions. It uses an argument which must be a pointer to an `int`, but instead of printing anything it stores the number of characters printed so far by this call at that location. The 'h' and 'l' type modifiers are permitted to specify that the argument is of type `short int *` or `long int *` instead of `int *`, but no flags, field width, or precision are permitted.
' %n ' 转换不同于任何其他输出转换。它使用一个参数，该参数必须是指向 `int` 的指针，但它不是打印任何内容，而是存储此调用在该位置打印的字符数。' h ' 和 ' l ' 类型 允许修饰符指定参数的类型 `short int *` 或 `long int *` 而不是 `int *`，但不允许使用标志、字段宽度或精度。

For example,

```c
int nchar;
printf ("%d %s%n\n", 3, "bears", &nchar);
```

prints:

3 bears

and sets `nchar` to `7`, because '3 bears' is seven characters.
并将 `nchar` 设置为 `7`，因为 ' 3 bears ' 是 7 个字符。

The '%%' conversion prints a literal '%' character. This conversion doesn't use an argument, and no flags, field width, precision, or type modifiers are permitted.
' %% ' 转换打印文本 ' % ' 字符。此转换不使用参数，并且不允许使用标志、字段宽度、精度或类型修饰符。

#### 12.12.7 Formatted Output Functions
格式化输出函数

This section describes how to call `printf` and related functions. Prototypes for these functions are in the header file stdio.h. Because these functions take a variable number of arguments, you *must* declare prototypes for them before using them. Of course, the easiest way to make sure you have all the right prototypes is to just include stdio.h.
本节介绍如何调用 `printf` 和相关函数。这些函数的原型位于 header file stdio.h 中。 由于这些函数采用可变数量的参数，因此 *必须在*使用它们之前为它们声明原型。当然，确保您拥有所有正确原型的最简单方法是只包含 stdio.h .

- int printf (const char *template, …)

- int wprintf (const wchar_t *template, …)

- int fprintf (FILE *stream, const char *template, …)

- int fwprintf (FILE *stream, const wchar_t *template, …)

- int sprintf (char *s, const char *template, …)

- int swprintf (wchar_t *ws, size_t size, const wchar_t *template, …)

- int snprintf (char *s, size_t size, const char *template, …)

#### 12.12.8 Dynamically Allocating Formatted Output
动态分配格式化输出

The functions in this section do formatted output and place the results in dynamically allocated memory.
本节中的函数执行格式化输出，并将结果放置在动态分配的内存中。

- int asprintf (char **ptr, const char *template, …)

- int obstack_printf (struct obstack *obstack, const char *template, …)

#### 12.12.9 Variable Arguments Output Functions
变量参数输出函数

The functions `vprintf` and friends are provided so that you can define your own variadic `printf`-like functions that make use of the same internals as the built-in formatted output functions.
提供了函数 `vprintf` 和 friends，以便您可以定义自己的类似 `printf` 的可变参数函数，这些函数使用与内置格式化输出函数相同的内部结构。

The most natural way to define such functions would be to use a language construct to say, "Call `printf` and pass this template plus all of my arguments after the first five." But there is no way to do this in C, and it would be hard to provide a way, since at the C language level there is no way to tell how many arguments your function received.
定义此类函数的最自然方法是使用语言结构来表示，"调用 `printf` 并传递此模板以及前五个之后的所有参数。但是在 C 语言中没有办法做到这一点，而且很难提供一种方法，因为在 C 语言级别没有办法告诉你的函数收到了多少个参数。

Since that method is impossible, we provide alternative functions, the `vprintf` series, which lets you pass a `va_list` to describe "all of my arguments after the first five."
由于该方法是不可能的，因此我们提供了替代函数， `vprintf` 系列，它允许您传递一个`va_list`来描述"前 5 个之后的所有参数"。

When it is sufficient to define a macro rather than a real function, the GNU C compiler provides a way to do this much more easily with macros. For example:
当定义宏而不是实际函数就足够时，GNU C 编译器提供了一种使用宏更容易地执行此操作的方法。例如：

```c
#define myprintf(a, b, c, d, e, rest...) \
        printf (mytemplate , ## rest)
```

See [Variadic Macros](https://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html#Variadic-Macros) in The C preprocessor, for details. But this is limited to macros, and does not apply to real functions at all.
有关详细信息，请参阅 C 预处理器中的 [Variadic 宏](https://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html#Variadic-Macros)。但这仅限于宏，根本不适用于实际函数。

Before calling `vprintf` or the other functions listed in this section, you *must* call `va_start` (see [Variadic Functions](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Variadic-Functions)) to initialize a pointer to the variable arguments. Then you can call `va_arg` to fetch the arguments that you want to handle yourself. This advances the pointer past those arguments.
在调用 `vprintf` 或本节中列出的其他函数之前，*必须*调用 `va_start`(请参阅 [可变参数函数](https://sourceware.org/glibc/manual/2.36/html_mono/libc.html#Variadic-Functions))以初始化指向变量参数的指针。然后，您可以调用 `va_arg` 来获取要自行处理的参数。这将使指针越过这些参数。

Once your `va_list` pointer is pointing at the argument of your choice, you are ready to call `vprintf`. That argument and all subsequent arguments that were passed to your function are used by `vprintf` along with the template that you specified separately.
一旦 `va_list` 指针指向所选的参数，就可以调用 `vprintf` 了。 那个论点和所有 传递给函数的后续参数由 `vprintf` 以及您单独指定的模板。

**Portability Note:** The value of the `va_list` pointer is undetermined after the call to `vprintf`, so you must not use `va_arg` after you call `vprintf`. Instead, you should call `va_end` to retire the pointer from service. You can call `va_start` again and begin fetching the arguments from the start of the variable argument list. (Alternatively, you can use `va_copy` to make a copy of the `va_list` pointer before calling `vfprintf`.) Calling `vprintf` does not destroy the argument list of your function, merely the particular pointer that you passed to it.
**可移植性说明：**调用 `vprintf` 后，`va_list`指针的值未确定，因此不得使用 `va_arg`调用 `vprintf` 后。 相反，您应该调用 `va_end` 以停用指针。 您可以调用 再次`va_start`并开始从变量参数列表的开头获取参数。(或者，您可以使用 `va_copy` `va_list`在调用 `vfprintf`.)调用 `vprintf` 不会销毁函数的参数列表，只会销毁您传递给它的特定指针。

Prototypes for these functions are declared in stdio.h.
这些函数的原型在 中 stdio.h 声明。

- int vprintf (const char *template, va_list ap)

- int vwprintf (const wchar_t *template, va_list ap)

- int vfprintf (FILE *stream, const char *template, va_list ap)

- int vfwprintf (FILE *stream, const wchar_t *template, va_list ap)

- int vsprintf (char *s, const char *template, va_list ap)

- int vswprintf (wchar_t *ws, size_t size, const wchar_t *template, va_list ap)

- int vsnprintf (char *s, size_t size, const char *template, va_list ap)

- int vasprintf (char **ptr, const char *template, va_list ap)

- int obstack_vprintf (struct obstack *obstack, const char *template, va_list ap)

#### 12.12.10 Parsing a Template String
解析模板字符串

You can use the function `parse_printf_format` to obtain information about the number and types of arguments that are expected by a given template string. This function permits interpreters that provide interfaces to `printf` to avoid passing along invalid arguments from the user's program, which could cause a crash.
您可以使用函数 `parse_printf_format` 获取有关给定模板字符串所需的参数数量和类型的信息。此函数允许向 `printf` 提供接口的解释器，以避免从用户程序传递无效参数，这可能会导致崩溃。

All the symbols described in this section are declared in the header file printf.h.
本节中描述的所有符号都在 header file printf.h 中声明。

- size_t parse_printf_format (const char *template, size_t n, int *argtypes)

- Macro: int PA_FLAG_MASK
